# STARsolo Pipeline for microSPLIT scRNA-seq Data Analysis

Pipeline for analyzing single-cell RNA sequencing (scRNA-seq) data generated with microSPLIT technology using STARsolo.

## Description

This project contains a series of scripts to analyze single-cell RNA-seq data generated with microSPLIT technology. It uses STARsolo, an implementation of the STAR pipeline dedicated to single-cell data, to align reads and quantify gene expression.

## Project Structure

```
.
├── create_env_starsolo.sh    # Script to create conda environment with STARsolo
├── create_links.sh           # Script to prepare directory structure and create symbolic links
├── run_starsolo_DOL_microsplit.sh  # Main STARsolo analysis script
└── raw_data/                 # Directory containing raw data
    ├── fastq/                # FASTQ files (reads)
    ├── barcodes/             # Barcode files
    ├── genome_ref/           # Genome reference files
    └── genome_annotation/    # Genome annotation files
```

## Prerequisites

- Conda/Miniconda
- Access to a computing cluster (script is configured for SLURM)
- Raw data organized as described in the following section

## Installation

1. Create the conda environment with STARsolo:

```bash
sbatch create_env_starsolo.sh
```

2. Organize your raw data:

You don't need to manually organize files in a specific structure. The `create_links.sh` script will automatically create the necessary symbolic links to your raw data in the following structure:

```
raw_data/
├── fastq/
│   ├── microSPLIT-600cells_S1_L001_R1_001.fastq.gz
│   └── microSPLIT-600cells_S1_L001_R2_001.fastq.gz
├── barcodes/
│   ├── barcode_round1.txt
│   ├── barcode_round2.txt
│   └── barcode_round3.txt
├── genome_ref/
│   └── GCA_030064105.1_ASM3006410v1_genomic.fna
└── genome_annotation/
    └── GCA_030064105.1_ASM3006410v1_genomic.gff
```

3. Create the necessary symbolic links:

Run the script that will set up all required symbolic links to your data:

```bash
sbatch create_links.sh
```

## Usage

Launch the STARsolo analysis:

```bash
sbatch run_starsolo_DOL_microsplit.sh
```

This script performs the following steps:
1. Converting GFF3 file to GTF
2. Correcting GTF file for compatibility with STAR
3. Generating genome index
4. Alignment and quantification with STARsolo
5. Verification and reporting of results

## Customizable Parameters

The main parameters can be modified in the `run_starsolo_DOL_microsplit.sh` script:

- `THREADS`: Number of threads to use
- `BASE_DIR`: Base directory for analysis
- Paths to input and output files
- Positions of cell barcodes and UMI in the reads

## Results

The results will be generated in the `Analysis_STARsolo_microsplit/Output_DOL_microsplit_starsolo/` directory with the following structure:

```
Analysis_STARsolo_microsplit/
├── genome_index/          # Genome index generated by STAR
└── starsolo_output/       # STARsolo analysis results
    ├── Log.final.out      # Summary of alignment statistics
    └── Solo.out/          # Results specific to single-cell analysis
        ├── Gene/          # Expression matrices at gene level
        └── GeneFull/      # Expression matrices with all reads
```

## Notes

- The analysis is specifically configured for microSPLIT technology with 3 rounds of cell barcoding.
- STAR alignment parameters are optimized for microSPLIT data. 