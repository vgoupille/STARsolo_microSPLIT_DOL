# STARsolo Pipeline for microSPLIT scRNA-seq Data Analysis

Pipeline for analyzing single-cell RNA sequencing (scRNA-seq) data generated with microSPLIT technology using STARsolo.

## Description

This project contains a series of scripts to analyze single-cell RNA-seq data generated with microSPLIT technology. It uses STARsolo, an implementation of the STAR pipeline dedicated to single-cell data, to align reads and quantify gene expression.

## Project Structure

```
.
├── config.sh                  # Configuration file with all parameters
├── run_pipeline.sh            # Main script to run the complete pipeline in one command
├── create_env_starsolo.sh     # Script to create conda environment with STARsolo (legacy)
├── create_links.sh            # Script to prepare directory structure and links (legacy)
├── run_starsolo_DOL_microsplit.sh  # STARsolo analysis script (legacy)
└── raw_data/                  # Directory containing raw data
    ├── fastq/                 # FASTQ files (reads)
    ├── barcodes/              # Barcode files
    ├── genome_ref/            # Genome reference files
    └── genome_annotation/     # Genome annotation files
```

## Prerequisites

- Conda/Miniconda
- Access to a computing cluster (script is configured for SLURM)
- Raw data organized as described in the configuration file

## Installation and Usage

### New Unified Approach (Recommended)

1. Edit the `config.sh` file to match your data paths and resource requirements:

```bash
nano config.sh
```

2. Run the complete pipeline with a single command:

```bash
sbatch run_pipeline.sh
```

This will automatically:
- Create the STARsolo environment (if needed)
- Set up the directory structure and create symbolic links
- Run the STARsolo analysis with the configured parameters

### Legacy Approach (Individual Scripts)

If you prefer, you can still run each step individually:

1. Create the conda environment with STARsolo:

```bash
sbatch create_env_starsolo.sh
```

2. Create the necessary symbolic links:

```bash
sbatch create_links.sh
```

3. Launch the STARsolo analysis:

```bash
sbatch run_starsolo_DOL_microsplit.sh
```

## Customizable Parameters

All parameters can be modified in the `config.sh` file:

- Email notification settings
- Analysis name and base directory
- Computational resources (threads, memory, runtime)
- Paths to source data
- File names for input and output

## Pipeline Steps

The pipeline performs the following steps:
1. Setting up the STARsolo environment
2. Creating the directory structure and symbolic links
3. Converting GFF3 file to GTF
4. Correcting GTF file for compatibility with STAR
5. Generating genome index
6. Alignment and quantification with STARsolo
7. Verification and reporting of results

## Results

The results will be generated in the configured output directory with the following structure:

```
Analysis_STARsolo_microsplit/
├── genome_index/          # Genome index generated by STAR
└── starsolo_output/       # STARsolo analysis results
    ├── Log.final.out      # Summary of alignment statistics
    └── Solo.out/          # Results specific to single-cell analysis
        ├── Gene/          # Expression matrices at gene level
        └── GeneFull/      # Expression matrices with all reads
```

## Notes

- The analysis is specifically configured for microSPLIT technology with 3 rounds of cell barcoding.
- STAR alignment parameters are optimized for microSPLIT data.
- The unified pipeline script replaces the need to run the three individual scripts separately. 